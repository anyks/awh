/**
 * author:    Yuriy Lobarev
 * telegram:  @forman
 * phone:     +7(910)983-95-90
 * email:     forman@anyks.com
 * site:      https://anyks.com
 * copyright: ¬© Yuriy Lobarev
 */

// –ü–æ–¥–∫–ª—é—á–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª
#include <core/http.hpp>

/**
 * date –ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–∞
 * @return —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞
 */
const string awh::Http::date() const noexcept {
	// –°–æ–∑–¥–∞—ë–º –±—É—Ñ–µ—Ä –¥–∞–Ω–Ω—ã—Ö
	char buffer[1000];
	// –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è
	time_t now = time(nullptr);
	// –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è
	struct tm tm = * gmtime(&now);
	// –ó–∞–Ω—É–ª—è–µ–º –±—É—Ñ–µ—Ä
	memset(buffer, 0, sizeof(buffer));
	// –ü–æ–ª—É—á–∞–µ–º —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏
	strftime(buffer, sizeof(buffer), "%a, %d %b %Y %H:%M:%S %Z", &tm);
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	return buffer;
}
/**
 * checkAuth –ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
 * @return —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
 */
awh::Http::stath_t awh::Http::checkAuth() noexcept {
	// –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
	stath_t result = stath_t::FAULT;
	// –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω —Ä–µ–∂–∏–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞
	if(this->mode == mode_t::RESPONSE){
		// –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞
		switch(this->query.code){
			// –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
			case 401:
			case 407: {
				// –ï—Å–ª–∏ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–æ–≤–µ—Å—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –µ—â—ë –Ω–µ–±—ã–ª–æ, –ø—Ä–æ–±—É–µ–º –µ—â—ë —Ä–∞–∑
				if(!this->failAuth && (this->authCli.getType() == auth_t::type_t::DIGEST)){
					// –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
					auto it = this->headers.find("www-authenticate");
					// –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞–π–¥–µ–Ω—ã
					if((this->failAuth = (it != this->headers.end()))){
						// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ HTTP –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
						this->authCli.setHeader(it->second);
						// –ü—Ä–æ—Å–∏–º –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –µ—â—ë —Ä–∞–∑
						result = stath_t::RETRY;
					}
				}
			} break;
			// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç
			case 301:
			case 308: {
				// –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
				auto it = this->headers.find("location");
				// –ï—Å–ª–∏ –∞–¥—Ä–µ—Å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω
				if(it != this->headers.end()){
					// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–∞—Ä—Å–∏–Ω–≥ URL
					uri_t::url_t tmp = this->uri->parseUrl(it->second);
					// –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL —Å—É—â–µ—Å—Ç–≤—É—é—Ç
					if(!this->url.params.empty())
						// –ü–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º—É —Å–ø–∏—Å–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
						for(auto & param : this->url.params) tmp.params.emplace(param);
					// –ú–µ–Ω—è–µ–º IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
					const_cast <uri_t::url_t *> (&this->url)->ip = move(tmp.ip);
					// –ú–µ–Ω—è–µ–º –ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞
					const_cast <uri_t::url_t *> (&this->url)->port = move(tmp.port);
					// –ú–µ–Ω—è–µ–º –Ω–∞ –ø—É—Ç—å —Å–µ—Ä–≤–µ—Ä–µ
					const_cast <uri_t::url_t *> (&this->url)->path = move(tmp.path);
					// –ú–µ–Ω—è–µ–º –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è —Å–µ—Ä–≤–µ—Ä–∞
					const_cast <uri_t::url_t *> (&this->url)->domain = move(tmp.domain);
					// –ú–µ–Ω—è–µ–º –ø—Ä–æ—Ç–æ–∫–æ–ª –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞
					const_cast <uri_t::url_t *> (&this->url)->schema = move(tmp.schema);
					// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
					const_cast <uri_t::url_t *> (&this->url)->params = move(tmp.params);
					// –ü—Ä–æ—Å–∏–º –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –µ—â—ë —Ä–∞–∑
					result = stath_t::RETRY;
				}
			} break;
			// –°–æ–æ–±—â–∞–µ–º, —á—Ç–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
			case 100:
			case 101:
			case 200:
			case 201:
			case 202:
			case 203:
			case 204:
			case 205:
			case 206: result = stath_t::GOOD; break;
		}
	// –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω —Ä–µ–∂–∏–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞
	} else if(this->mode == mode_t::REQUEST) {
		// –ï—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è
		if(this->authSrv.getType() != auth_t::type_t::NONE){
			// –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
			auto it = this->headers.find("authorization");
			// –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞–π–¥–µ–Ω—ã
			if(it != this->headers.end()){
				// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ HTTP –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
				this->authSrv.setHeader(it->second);
				// –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
				if(this->authSrv.check())
					// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
					result = http_t::stath_t::GOOD;
			}
		// –°–æ–æ–±—â–∞–µ–º, —á—Ç–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
		} else result = http_t::stath_t::GOOD;
	}
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	return result;
}
/**
 * update –ú–µ—Ç–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
 */
void awh::Http::update() noexcept {
	// –ï—Å–ª–∏ —Ç–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω–æ
	if(!this->body.empty()){
		// –û—Ç–∫–ª—é—á–∞–µ–º —Å–∂–∞—Ç–∏–µ –æ—Ç–≤–µ—Ç–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞
		this->compress = compress_t::NONE;
		// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
		auto it = this->headers.find("x-awh-encryption");
		// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞–π–¥–µ–Ω
		if((this->crypt = (it != this->headers.end()))){
			// –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–º–µ—Ä —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
			switch(stoi(it->second)){
				// –ï—Å–ª–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ 128 –±–∏—Ç–Ω—ã–º –∫–ª—é—á—ë–º
				case 128: this->hash.setAES(hash_t::aes_t::AES128); break;
				// –ï—Å–ª–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ 192 –±–∏—Ç–Ω—ã–º –∫–ª—é—á—ë–º
				case 192: this->hash.setAES(hash_t::aes_t::AES192); break;
				// –ï—Å–ª–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ 256 –±–∏—Ç–Ω—ã–º –∫–ª—é—á—ë–º
				case 256: this->hash.setAES(hash_t::aes_t::AES256); break;
			}
			// –í—ã–ø–æ–ª–Ω—è–µ–º –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
			const auto & res = this->hash.decrypt(this->body.data(), this->body.size());
			// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã, –∑–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
			if(!res.empty()) this->body.assign(res.begin(), res.end());
		}
		// –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∏—à–ª–∏ –ª–∏ —Å–∂–∞—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ
		it = this->headers.find("content-encoding");
		// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—à–ª–∏ —Å–∂–∞—Ç—ã–µ
		if(it != this->headers.end()){
			// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—à–ª–∏ —Å–∂–∞—Ç—ã–µ –º–µ—Ç–æ–¥–æ–º Brotli
			if(it->second.compare("br") == 0){
				// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏—é —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
				this->compress = compress_t::BROTLI;
				// –í—ã–ø–æ–ª–Ω—è–µ–º –¥–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏—é –¥–∞–Ω–Ω—ã—Ö
				const auto & body = this->hash.decompressBrotli(this->body.data(), this->body.size());
				// –ó–∞–º–µ–Ω—è–µ–º –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ —Ç–µ–ª–æ
				if(!body.empty()) this->body.assign(body.begin(), body.end());
			// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—à–ª–∏ —Å–∂–∞—Ç—ã–µ –º–µ—Ç–æ–¥–æ–º GZip
			} else if(it->second.compare("gzip") == 0) {
				// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏—é —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
				this->compress = compress_t::GZIP;
				// –í—ã–ø–æ–ª–Ω—è–µ–º –¥–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏—é –¥–∞–Ω–Ω—ã—Ö
				const auto & body = this->hash.decompressGzip(this->body.data(), this->body.size());
				// –ó–∞–º–µ–Ω—è–µ–º –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ —Ç–µ–ª–æ
				if(!body.empty()) this->body.assign(body.begin(), body.end());
			// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—à–ª–∏ —Å–∂–∞—Ç—ã–µ –º–µ—Ç–æ–¥–æ–º Deflate
			} else if(it->second.compare("deflate") == 0) {
				// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏—é —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
				this->compress = compress_t::DEFLATE;
				// –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–µ–ª–∞ –≤ –±–∏–Ω–∞—Ä–Ω–æ–º –≤–∏–¥–µ
				vector <char> buffer(this->body.begin(), this->body.end());
				// –î–æ–±–∞–≤–ª—è–µ–º —Ö–≤–æ—Å—Ç –≤ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
				this->hash.setTail(buffer);
				// –í—ã–ø–æ–ª–Ω—è–µ–º –¥–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏—é –¥–∞–Ω–Ω—ã—Ö
				const auto & body = this->hash.decompress(buffer.data(), buffer.size());
				// –ó–∞–º–µ–Ω—è–µ–º –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ —Ç–µ–ª–æ
				if(!body.empty()) this->body.assign(body.begin(), body.end());
			}
		}
	}
}
/**
 * clear –ú–µ—Ç–æ–¥ –æ—á–∏—Å—Ç–∫–∏ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
 */
void awh::Http::clear() noexcept {
	// –í—ã–ø–æ–ª–Ω—è–µ–º –æ—á–∏—Å—Ç–∫—É —Ç–µ–ª–∞ HTTP –∑–∞–ø—Ä–æ—Å–∞
	this->body.clear();
	// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–±—Ä–æ—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
	this->url.clear();
	// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–±—Ä–æ—Å —á—ë—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
	this->black.clear();
	// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–±—Ä–æ—Å –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö HTTP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
	this->headers.clear();
	// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–±—Ä–æ—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–∞–Ω–∫–∞
	this->chunk = chunk_t();
	// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–±—Ä–æ—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
	this->query = query_t();
}
/**
 * reset –ú–µ—Ç–æ–¥ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
 */
void awh::Http::reset() noexcept {
	// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–±—Ä–æ—Å —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–ª–∞
	this->bodySize = -1;
	// –û–±–Ω—É–ª—è–µ–º —Ñ–ª–∞–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
	this->failAuth = false;
	// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–±—Ä–æ—Å —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –º–æ–¥—É–ª—è
	this->mode = mode_t::NONE;
	// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–±—Ä–æ—Å —Å—Ç–µ–π—Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
	this->stath = stath_t::EMPTY;
	// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–±—Ä–æ—Å —Å—Ç–µ–π—Ç–∞ —Ç–µ–∫—É—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
	this->state = state_t::QUERY;
}
/**
 * addBlack –ú–µ—Ç–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –≤ —á—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
 * @param key –∫–ª—é—á –∑–∞–≥–æ–ª–æ–≤–∫–∞
 */
void awh::Http::addBlack(const string & key) noexcept {
	// –ï—Å–ª–∏ –∫–ª—é—á –∑–∞–≥–æ–ª–æ–≤–∫–∞ –ø–µ—Ä–µ–¥–∞–Ω, –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫
	if(!key.empty()) this->black.emplace(this->fmk->toLower(key));
}
/**
 * parse –ú–µ—Ç–æ–¥ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
 * @param buffer –±—É—Ñ–µ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
 * @param size   —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
 */
void awh::Http::parse(const char * buffer, const size_t size) noexcept {
	// –ï—Å–ª–∏ —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–µ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
	if((this->state != state_t::HANDSHAKE) && (this->state != state_t::BROKEN)){
		// –ï—Å–ª–∏ –º—ã —Å–æ–±–∏—Ä–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏–ª–∏ —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
		if((this->state == state_t::HEADERS) || (this->state == state_t::QUERY)){
			// –ü–æ–∑–∏—Ü–∏—è –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è
			size_t pos = string::npos;
			// –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞
			const string http(buffer, size);
			// –ï—Å–ª–∏ –≤—Å–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –ø–æ–ª—É—á–µ–Ω—ã
			if((pos = http.find("\r\n\r\n")) != string::npos){
				// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–±—Ä–æ—Å —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–ª–∞
				this->bodySize = -1;
				// –í—ã–ø–æ–ª–Ω—è–µ–º —á—Ç–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞
				readHeader(http.data(), pos, [this](string data) noexcept {
					// –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã
					switch((uint8_t) this->state){
						// –ï—Å–ª–∏ - —ç—Ç–æ —Ä–µ–∂–∏–º –æ–∂–∏–¥–∞–Ω–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞
						case (uint8_t) state_t::QUERY: {
							// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
							size_t offset = data.find("HTTP/");
							// –ï—Å–ª–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞–π–¥–µ–Ω
							if(offset != string::npos){
								// –í—ã–ø–æ–ª–Ω—è–µ–º –æ—á–∏—Å—Ç–∫—É –≤—Å–µ—Ö —Ä–∞–Ω–µ–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
								this->clear();
								// –ï—Å–ª–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–∞—á–∞–µ –∑–∞–ø—Ä–æ—Å–∞
								if(offset == 0){
									// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è
									offset = data.find(" ", 5);
									// –ï—Å–ª–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω
									if(offset != string::npos){
										// –ü–æ–ª—É—á–∞–µ–º –≤–µ—Ä—Å–∏—é –ø—Ä–æ—Ç–æ–∫–æ–ª –∑–∞–ø—Ä–æ—Å–∞
										this->query.ver = stod(data.substr(5, offset - 5));
										// –£–¥–∞–ª—è–µ–º –ª–∏—à–Ω–∏–µ —Å–∏–º–≤–æ–ª—ã
										data.erase(data.begin(), data.begin() + (offset + 1));
										// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ –≤—Ç–æ—Ä–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è
										offset = data.find(" ");
										// –ï—Å–ª–∏ –ø—Ä–æ–±–µ–ª –ø–æ–ª—É—á–µ–Ω
										if(offset != string::npos){
											// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (–ø–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞)
											this->mode = mode_t::RESPONSE;
											// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–º–µ–Ω—É —Å—Ç–µ–π—Ç–∞
											this->state = state_t::HEADERS;
											// –ü–æ–ª—É—á–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞
											this->query.message = data.substr(offset + 1);
											// –ü–æ–ª—É—á–∞–µ–º –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞
											this->query.code = stoi(data.substr(0, offset));
											// –í—ã—Ö–æ–¥–∏–º –∏–∑ —É—Å–ª–æ–≤–∏—è
											break;
										}
									}
								// –ï—Å–ª–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ –∑–∞–ø—Ä–æ—Å–∞
								} else {
									// –ü–æ–ª—É—á–∞–µ–º –≤–µ—Ä—Å–∏—é –ø—Ä–æ—Ç–æ–∫–æ–ª –∑–∞–ø—Ä–æ—Å–∞
									this->query.ver = stod(data.substr(offset + 5));
									// –£–¥–∞–ª—è–µ–º –ª–∏—à–Ω–∏–µ —Å–∏–º–≤–æ–ª—ã
									data.erase(data.begin() + (offset - 1), data.end());
									// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è
									offset = data.find(" ");
									// –ï—Å–ª–∏ –ø—Ä–æ–±–µ–ª –ø–æ–ª—É—á–µ–Ω
									if(offset != string::npos){
										// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (–ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞)
										this->mode = mode_t::REQUEST;
										// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–º–µ–Ω—É —Å—Ç–µ–π—Ç–∞
										this->state = state_t::HEADERS;
										// –ü–æ–ª—É—á–∞–µ–º URI –∑–∞–ø—Ä–æ—Å–∞
										this->query.uri = data.substr(offset + 1);
										// –ü–æ–ª—É—á–∞–µ–º –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞
										const string & method = this->fmk->toLower(data.substr(0, offset));
										// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –∫–∞–∫ GET
										if(method.compare("get") == 0) this->query.method = method_t::GET;
										// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –∫–∞–∫ PUT
										else if(method.compare("put") == 0) this->query.method = method_t::PUT;
										// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –∫–∞–∫ POST
										else if(method.compare("post") == 0) this->query.method = method_t::POST;
										// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –∫–∞–∫ HEAD
										else if(method.compare("head") == 0) this->query.method = method_t::HEAD;
										// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –∫–∞–∫ DELETE
										else if(method.compare("delete") == 0) this->query.method = method_t::DEL;
										// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –∫–∞–∫ PATCH
										else if(method.compare("patch") == 0) this->query.method = method_t::PATCH;
										// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –∫–∞–∫ TRACE
										else if(method.compare("trace") == 0) this->query.method = method_t::TRACE;
										// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –∫–∞–∫ OPTIONS
										else if(method.compare("options") == 0) this->query.method = method_t::OPTIONS;
										// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –∫–∞–∫ CONNECT
										else if(method.compare("connect") == 0) this->query.method = method_t::CONNECT;
										// –í—ã—Ö–æ–¥–∏–º –∏–∑ —É—Å–ª–æ–≤–∏—è
										break;
									}
								}
							}
							// –°–æ–æ–±—â–∞–µ–º, —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞
							this->stath = stath_t::FAULT;
						} break;
						// –ï—Å–ª–∏ - —ç—Ç–æ —Ä–µ–∂–∏–º –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
						case (uint8_t) state_t::HEADERS: {
							// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ –ø—Ä–æ–±–µ–ª–∞
							size_t pos = data.find(":");
							// –ï—Å–ª–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω
							if(pos != string::npos){
								// –ü–æ–ª—É—á–∞–µ–º –∫–ª—é—á –∑–∞–≥–æ–ª–æ–≤–∫–∞
								const string & key = this->fmk->trim(data.substr(0, pos));
								// –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
								const string & val = this->fmk->trim(data.substr(pos + 1));
								// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ —Å–ø–∏—Å–æ–∫ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
								if(!key.empty() && !val.empty())
									// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ —Å–ø–∏—Å–æ–∫
									this->headers.emplace(this->fmk->toLower(key), val);
							}
						} break;
					}
				});
				// –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞
				auto it = this->headers.find("content-length");
				// –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –ø–µ—Ä–µ–¥–∞–Ω
				if(it != this->headers.end()){
					// –ó–∞–ø–æ–º–∏–Ω–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
					this->bodySize = stoull(it->second);
					// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–µ–π—Ç –ø–æ–∏—Å–∫–∞ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
					this->state = state_t::BODY;
					// –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É
					goto end;
				// –ï—Å–ª–∏ —Ç–µ–ª–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç
				} else {
					// –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞
					it = this->headers.find("transfer-encoding");
					// –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –ø–µ—Ä–µ–¥–∞–Ω
					if(it != this->headers.end()){
						// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ —á–∞–Ω–∫–∞–º–∏
						if(it->second.find("chunked") != string::npos){
							// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–µ–π—Ç –ø–æ–∏—Å–∫–∞ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
							this->state = state_t::BODY;
							// –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É
							goto end;
						}
					}
				}
				// –¢–µ–ª–æ –≤ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–æ
				this->state = state_t::GOOD;
				// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–µ—Ç–∫—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã
				end:
				// –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É
				this->parse(http.data() + (pos + 4), http.size() - (pos + 4));
			}
		// –ï—Å–ª–∏ –º—ã —Å–æ–±–∏—Ä–∞–µ–º —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ –∏–ª–∏ –∑–∞–≤–µ—Ä—à–∞–µ–º —Ä–∞–±–æ—Ç—É
		} else {
			// –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã
			switch((uint8_t) this->state){
				// –ï—Å–ª–∏ - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–±—Ä–∞–Ω—ã
				case (uint8_t) state_t::GOOD: {
					// –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
					this->stath = this->checkAuth();
					// –ï—Å–ª–∏ –∫–ª—é—á —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç
					if(this->stath == stath_t::GOOD)
						// –í—ã–ø–æ–ª–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
						this->update();
					// –ü–æ–º–µ–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ –±—Ä–∞–∫–æ–≤–∞–Ω–Ω—ã–µ
					else this->state = state_t::BROKEN;
				} break;
				// –ï—Å–ª–∏ - —ç—Ç–æ —Ä–µ–∂–∏–º –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–ª–∞
				case (uint8_t) state_t::BODY: {
					// –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—É—á–µ–Ω
					if(size > 0){
						// –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω
						if(this->bodySize > -1){
							// –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ –Ω–µ –ø–æ–ª—É—á–µ–Ω
							if(this->bodySize == 0){
								// –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–ª–∞
								this->chunk.data.assign(buffer, buffer + size);
								// –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
								if(this->chunkingFn != nullptr)
									// –í—ã–≤–æ–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
									this->chunkingFn(this->chunk.data, this);
							// –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π
							} else {
								// –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞
								size_t actual = (this->bodySize - this->body.size());
								// –§–∏–∫—Å–∏—Ä—É–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞
								actual = (size > actual ? actual : size);
								// –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ–±—â–∏–π —Ä–∞–∑–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
								this->chunk.size += actual;
								// –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–ª–∞
								this->chunk.data.assign(buffer, buffer + actual);
								// –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
								if(this->chunkingFn != nullptr)
									// –í—ã–≤–æ–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
									this->chunkingFn(this->chunk.data, this);
								// –ï—Å–ª–∏ —Ç–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–±—Ä–∞–Ω–Ω–æ
								if(this->bodySize == this->chunk.size){
									// –û—á–∏—â–∞–µ–º —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
									this->chunk.clear();
									// –¢–µ–ª–æ –≤ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–æ
									this->state = state_t::GOOD;
									// –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É
									this->parse(buffer, size);
									// –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏
									break;
								}
							}
						// –ï—Å–ª–∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤–µ–¥—ë—Ç—Å—è —á–∞–Ω–∫–∞–º–∏
						} else {
							// –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–µ–ª–∞
							string body(buffer, size);
							// –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ –Ω–µ –ø–æ–ª—É—á–µ–Ω
							if(this->chunk.size == 0){
								// –ò—â–µ–º —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞
								const size_t pos = body.find("\r\n");
								// –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ –Ω–∞–π–¥–µ–Ω
								if(pos != string::npos){
									// –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä –≤ 16-–º –≤–∏–¥–µ
									string hex = body.substr(0, pos);
									// –ï—Å–ª–∏ —á–∞—Å—Ç—å —Ä–∞–∑–º–µ—Ä–∞ 16-–≥–æ —á–∏—Å–ª–∞ —É–∂–µ –ø–æ–ª—É—á–∏–ª–∏ —Ä–∞–Ω–µ–µ
									if(!this->chunk.data.empty()){
										// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–±–æ—Ä–∫—É –≤—Å–µ–π —Å–æ—Å—Ç–∞–≤–ª—è—é—â–µ–π 16-–≥–æ —á–∏—Å–ª–∞ —Ä–∞–∑–º–µ—Ä–∞ —á–∞–Ω–∫–∞
										hex.insert(hex.begin(), this->chunk.data.begin(), this->chunk.data.end());
										// –û—á–∏—â–∞–µ–º —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
										this->chunk.clear();
									}
									// –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞
									this->chunk.size = (this->fmk->hexToDec(hex) + 2);
									// –ï—Å–ª–∏ —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞–Ω–∫
									if(this->chunk.size == 2){
										// –û—á–∏—â–∞–µ–º —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
										this->chunk.clear();
										// –¢–µ–ª–æ –≤ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–æ
										this->state = state_t::GOOD;
										// –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É
										this->parse(buffer, size);
										// –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏
										break;
									}
									// –£–¥–∞–ª—è–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
									body.erase(body.begin(), body.begin() + (pos + 2));
								}
							}
							// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—â—ë –µ—Å—Ç—å, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å–æ–±–∏—Ä–∞—Ç—å
							if(!body.empty()){
								// –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞
								size_t actual = (this->chunk.size - this->chunk.data.size());
								// –§–∏–∫—Å–∏—Ä—É–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞
								actual = (body.size() > actual ? actual : body.size());
								// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—â—ë –µ—Å—Ç—å –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º —á–∞–Ω–∫ –æ—á–∏—â–µ–Ω, –∑–Ω–∞—á–∏—Ç –º—ã –ø–æ–ª—É—á–∏–ª–∏ —á–∞—Å—Ç—å —Ä–∞–∑–º–µ—Ä–∞ 16-–≥–æ —á–∏—Å–ª–∞
								if(!body.empty() && (this->chunk.size == 0))
									// –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —á–∞—Å—Ç—å —Ä–∞–∑–º–µ—Ä–∞ 16-–≥–æ —á–∏—Å–ª–∞ –≤ —Ç–µ–ª–æ (–Ω—É –∞ –∫—É–¥–∞ –Ω–∞–º –µ—â—ë –µ–≥–æ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å ü§™)
									this->chunk.data.assign(body.begin(), body.end());
								// –ï—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
								else if(actual > 0){
									// –°–æ–±–∏—Ä–∞–µ–º —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞
									this->chunk.data.insert(this->chunk.data.end(), body.begin(), body.begin() + actual);
									// –ï—Å–ª–∏ –≤–µ—Å—å —á–∞–Ω–∫ —Å–æ–±—Ä–∞–Ω
									if(this->chunk.size == this->chunk.data.size()){
										// –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
										if(this->chunkingFn != nullptr){
											// –£–¥–∞–ª—è–µ–º —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
											this->chunk.data.pop_back();
											this->chunk.data.pop_back();
											// –í—ã–≤–æ–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
											this->chunkingFn(this->chunk.data, this);
										}
										// –û—á–∏—â–∞–µ–º —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
										this->chunk.clear();
										// –£–¥–∞–ª—è–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
										body.erase(body.begin(), body.begin() + actual);
										// –ï—Å–ª–∏ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ –µ—â—ë –Ω–µ –≤—Å—ë –ø—Ä–æ—á–∏—Ç–∞–Ω–æ
										if(!body.empty()) this->parse(body.data(), body.size());
									}
								}
							}
						}
					}
				} break;
			}
		}
	}
}
/**
 * addBody –ú–µ—Ç–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞ —Ç–µ–ª–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞
 * @param buffer –±—É—Ñ–µ—Ä –¥–∞–Ω–Ω—ã—Ö —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
 * @param size   —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
 */
void awh::Http::addBody(const char * buffer, const size_t size) noexcept {
	// –ï—Å–ª–∏ –¥–∞–Ω—ã–Ω–µ –ø–µ—Ä–µ–¥–∞–Ω—ã
	if((buffer != nullptr) && (size > 0))
		// –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±—É—Ñ–µ—Ä–∞ –≤ –±—É—Ñ–µ—Ä —Ç–µ–ª–∞
		this->body.insert(this->body.end(), buffer, buffer + size);
}
/**
 * addHeader –ú–µ—Ç–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞
 * @param key –∫–ª—é—á –∑–∞–≥–æ–ª–æ–≤–∫–∞
 * @param val –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
 */
void awh::Http::addHeader(const string & key, const string & val) noexcept {
	// –ï—Å–ª–∏ –¥–∞–Ω—ã–Ω–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –ø–µ—Ä–µ–¥–∞–Ω—ã
	if(!key.empty() && !val.empty())
		// –í—ã–ø–æ–ª–Ω—è–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞
		this->headers.emplace(key, val);
}
/**
 * getBody –ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
 * @return –±—É—Ñ–µ—Ä –¥–∞–Ω–Ω—ã—Ö —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
 */
const vector <char> & awh::Http::getBody() const noexcept {
	// –í—ã–≤–æ–¥–∏–º –¥–∞–Ω–Ω—ã–µ —Ç–µ–ª–∞
	return this->body;
}
/**
 * chunkBody –ú–µ—Ç–æ–¥ —á—Ç–µ–Ω–∏—è —á–∞–Ω–∫–∞ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
 * @return —Ç–µ–∫—É—â–∏–π —á–∞–Ω–∫ –∑–∞–ø—Ä–æ—Å–∞
 */
const vector <char> awh::Http::chunkBody() const noexcept {
	// –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
	vector <char> result;
	// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Ç–µ–ª–∞ –µ—â—ë —Å—É—â–µ—Å—Ç–≤—É—é—Ç
	if(!this->body.empty()){
		// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ç–µ–ª–æ –≤—ã–≤–æ–¥–∏—Ç—å –≤ –≤–∏–¥–µ —á–∞–Ω–∫–æ–≤
		if(this->chunking){
			// –¢–µ–ª–æ —á–∞–Ω–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
			string chunk = "";
			// –ï—Å–ª–∏ —Ç–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ–ª—å—à–µ —Ä–∞–∑–º–µ—Ä–∞ —á–∞–Ω–∫–∞
			if(this->body.size() >= this->chunkSize){
				// –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞
				chunk = this->fmk->decToHex(this->chunkSize);
				// –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
				chunk.append("\r\n");
				// –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–ª–æ —á–∞–Ω–∫–∞
				chunk.insert(chunk.end(), this->body.begin(), this->body.begin() + this->chunkSize);
				// –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω–µ—Ü –∑–∞–ø—Ä–æ—Å–∞
				chunk.append("\r\n");
				// –£–¥–∞–ª—è–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–µ–ª–µ —Å–æ–æ–±—â–µ–Ω–∏—è
				this->body.erase(this->body.begin(), this->body.begin() + this->chunkSize);
			// –ï—Å–ª–∏ —Ç–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–±–∏—Ä–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞
			} else {
				// –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞
				chunk = this->fmk->decToHex(this->body.size());
				// –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
				chunk.append("\r\n");
				// –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–ª–æ —á–∞–Ω–∫–∞
				chunk.insert(chunk.end(), this->body.begin(), this->body.end());
				// –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω–µ—Ü –∑–∞–ø—Ä–æ—Å–∞
				chunk.append("\r\n0\r\n\r\n");
				// –û—á–∏—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–µ–ª–∞
				this->body.clear();
			}
			// –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
			result.assign(chunk.begin(), chunk.end());
			// –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –ø–∞–º—è—Ç—å
			string().swap(chunk);
		// –í—ã–≤–æ–¥–∏–º –¥–∞–Ω–Ω—ã–µ —Ç–µ–ª–∞ –∫–∞–∫ –µ—Å—Ç—å
		} else {
			// –ï—Å–ª–∏ —Ç–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ–ª—å—à–µ —Ä–∞–∑–º–µ—Ä–∞ —á–∞–Ω–∫–∞
			if(this->body.size() >= this->chunkSize){
				// –ü–æ–ª—É—á–∞–µ–º –Ω—É–∂–Ω—ã–π –Ω–∞–º —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
				result.assign(this->body.begin(), this->body.begin() + this->chunkSize);
				// –£–¥–∞–ª—è–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–µ–ª–µ —Å–æ–æ–±—â–µ–Ω–∏—è
				this->body.erase(this->body.begin(), this->body.begin() + this->chunkSize);
			// –ï—Å–ª–∏ —Ç–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–±–∏—Ä–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞
			} else {
				// –ü–æ–ª—É—á–∞–µ–º –Ω—É–∂–Ω—ã–π –Ω–∞–º —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
				result.assign(this->body.begin(), this->body.end());
				// –û—á–∏—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–µ–ª–∞
				this->body.clear();
			}
		}
	}
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	return result;
}
/**
 * getHeader –ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–∞
 * @param key –∫–ª—é—á –∑–∞–≥–æ–ª–æ–≤–∫–∞
 * @return    –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
 */
const string & awh::Http::getHeader(const string & key) const noexcept {
	// –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
	static string result = "";
	// –ï—Å–ª–∏ –∫–ª—é—á –∑–∞–≥–æ–ª–æ–≤–∫–∞ –ø–µ—Ä–µ–¥–∞–Ω
	if(!key.empty()){
		// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ –∫–ª—é—á–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞
		auto it = this->headers.find(key);
		// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞–π–¥–µ–Ω
		if(it != this->headers.end()) return it->second;
	}
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	return result;
}
/**
 * getHeaders –ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
 * @return —Å–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
 */
const unordered_multimap <string, string> & awh::Http::getHeaders() const noexcept {
	// –í—ã–≤–æ–¥–∏–º —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
	return this->headers;
}
/**
 * readHeader –§—É–Ω–∫—Ü–∏—è —á—Ç–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏–∑ –±—É—Ñ–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
 * @param buffer   –±—É—Ñ–µ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —á—Ç–µ–Ω–∏—è
 * @param size     —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —á—Ç–µ–Ω–∏—è
 * @param callback —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
 */
void awh::Http::readHeader(const char * buffer, const size_t size, function <void (string)> callback) noexcept {
	// –ï—Å–ª–∏ —Ñ–∞–π–ª –ø—Ä–æ—á–∏—Ç–∞–Ω —É–¥–∞—á–Ω–æ
	if((buffer != nullptr) && (size > 0)){
		// –ó–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –±—É–∫–≤—ã
		char letter = 0, old = 0;
		// –°–º–µ—â–µ–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä–µ –∏ –¥–ª–∏–Ω–∞ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
		size_t offset = 0, length = 0;
		// –ü–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º—É –±—É—Ñ–µ—Ä—É
		for(size_t i = 0; i < size; i++){
			// –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –±—É–∫–≤—ã
			letter = buffer[i];
			// –ï—Å–ª–∏ —Ç–µ–∫—É—â–∞—è –±—É–∫–≤–∞ —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–µ–Ω–æ—Å–æ–º —Å—Ç—Ä–æ–∫
			if((i > 0) && ((letter == '\n') || (i == (size - 1)))){
				// –ï—Å–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∞—è –±—É–∫–≤–∞ –±—ã–ª–∞ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∫–∞—Ä–µ—Ç–∫–∏, —É–º–µ–Ω—å—à–∞–µ–º –¥–ª–∏–Ω—É —Å—Ç—Ä–æ–∫–∏
				length = ((old == '\r' ? i - 1 : i) - offset);
				// –ï—Å–ª–∏ —Å–∏–º–≤–æ–ª —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º –∏ –æ–Ω –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–µ–Ω–æ—Å–æ–º —Å—Ç—Ä–æ–∫–∏
				if((i == (size - 1)) && (letter != '\n')) length++;
				// –ï—Å–ª–∏ –¥–ª–∏–Ω–∞ —Å–ª–æ–≤–∞ –ø–æ–ª—É—á–µ–Ω–∞, –≤—ã–≤–æ–¥–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É
				callback(string(buffer + offset, length));
				// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–º–µ—â–µ–Ω–∏–µ
				offset = (i + 1);
			}
			// –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –±—É–∫–≤—É
			old = letter;
		}
	}
}
/**
 * getAuth –ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
 * @return —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
 */
awh::Http::stath_t awh::Http::getAuth() const noexcept {
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
	return this->stath;
}
/**
 * getCompress –ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞ —Å–∂–∞—Ç–∏—è
 * @return –º–µ—Ç–æ–¥ —Å–∂–∞—Ç–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
 */
awh::Http::compress_t awh::Http::getCompress() const noexcept {
	// –í—ã–≤–æ–¥–∏–º –º–µ—Ç–æ–¥ —Å–∂–∞—Ç–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
	return this->compress;
}
/**
 * setCompress –ú–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –º–µ—Ç–æ–¥–∞ —Å–∂–∞—Ç–∏—è
 * @param –º–µ—Ç–æ–¥ —Å–∂–∞—Ç–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
 */
void awh::Http::setCompress(const compress_t compress) noexcept {
	// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–µ—Ç–æ–¥ —Å–∂–∞—Ç–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
	this->compress = compress;
}
/**
 * getUrl –ú–µ—Ç–æ–¥ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
 * @return —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
 */
const awh::uri_t::url_t & awh::Http::getUrl() const noexcept {
	// –í—ã–≤–æ–¥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
	return this->url;
}
/**
 * isEnd –ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
 * @return —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
 */
bool awh::Http::isEnd() const noexcept {
	// –í—ã–≤–æ–¥—Ä–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
	return (
		(this->state == state_t::GOOD) ||
		(this->state == state_t::BROKEN) ||
		(this->state == state_t::HANDSHAKE)
	);
}
/**
 * isCrypt –ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
 * @return —Ñ–ª–∞–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
 */
bool awh::Http::isCrypt() const noexcept {
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
	return this->crypt;
}
/**
 * isAlive –ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
 * @return —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
 */
bool awh::Http::isAlive() const noexcept {
	// –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
	bool result = true;
	// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
	auto it = this->headers.find("connection");
	// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞–π–¥–µ–Ω
	if(it != this->headers.end())
		// –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç—ã–º
		result = (it->second.compare("close") != 0);
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	return result;
}
/**
 * isHandshake –ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏—è
 * @return –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏—è
 */
bool awh::Http::isHandshake() noexcept {
	// –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ —É–¥–∞—á–Ω–æ–µ —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–µ
	return (this->state == state_t::HANDSHAKE);
}
/**
 * isBlack –ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –≤ —á—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫–µ
 * @param key –∫–ª—é—á –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
 * @return    —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
 */
bool awh::Http::isBlack(const string & key) const noexcept {
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
	return (this->black.count(this->fmk->toLower(key)) > 0);
}
/**
 * isHeader –ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞
 * @param key –∫–ª—é—á –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
 * @return    —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
 */
bool awh::Http::isHeader(const string & key) const noexcept {
	// –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
	bool result = false;
	// –ï—Å–ª–∏ –∫–ª—é—á –ø–µ—Ä–µ–¥–∞–Ω
	if(!key.empty()){
		// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ –∫–ª—é—á–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞
		auto it = this->headers.find(this->fmk->toLower(key));
		// –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞
		result = (it != this->headers.end());
	}
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	return result;
}
/**
 * getQuery –ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞
 * @return –æ–±—ä–µ–∫—Ç –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞
 */
const awh::Http::query_t & awh::Http::getQuery() const noexcept {
	// –í—ã–≤–æ–¥–∏–º –æ–±—ä–µ–∫—Ç –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞
	return this->query;
}
/**
 * setQuery –ú–µ—Ç–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞
 * @param query –æ–±—ä–µ–∫—Ç –∑–∞–ø—Ä–æ—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞
 */
void awh::Http::setQuery(const query_t & query) noexcept {
	// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—ä–µ–∫—Ç –∑–∞–ø—Ä–æ—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞
	this->query = query;
}
/**
 * getMessage –ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è HTTP —Å–æ–æ–±—â–µ–Ω–∏—è
 * @param code –∫–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏–µ
 * @return     —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –∫–æ–¥—É HTTP —Å–æ–æ–±—â–µ–Ω–∏–µ
 */
const string & awh::Http::getMessage(const u_short code) const noexcept {
	/**
	 * –ü–æ–¥—Ä–æ–±–Ω–µ–µ: https://developer.mozilla.org/ru/docs/Web/HTTP/Status
	 */
	// –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
	static string result = "";
	// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ –∫–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
	auto it = this->messages.find(code);
	// –ï—Å–ª–∏ –∫–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω
	if(it != this->messages.end()) return it->second;
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	return result;
}
/**
 * proxy –ú–µ—Ç–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–µ
 * @param url –æ–±—ä–µ–∫—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ REST –∑–∞–ø—Ä–æ—Å–∞
 * @return    –±—É—Ñ–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ –≤ –±–∏–Ω–∞—Ä–Ω–æ–º –≤–∏–¥–µ
 */
vector <char> awh::Http::proxy(const uri_t::url_t & url) noexcept {
	// –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
	vector <char> result;
	// –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã REST –∑–∞–ø—Ä–æ—Å–∞ –ø–µ—Ä–µ–¥–∞–Ω—ã
	if(!url.empty()){
		// –ü–æ–ª—É—á–∞–µ–º —Ö–æ—Å—Ç —Å–µ—Ä–≤–µ—Ä–∞
		const string & host = (!url.domain.empty() ? url.domain : url.ip);
		// –ï—Å–ª–∏ —Ö–æ—Å—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–ª—É—á–µ–Ω
		if(!host.empty() && (url.port > 0)){
			// –î–æ–±–∞–≤–ª—è–µ–º –≤ —á—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Accept
			this->addBlack("Accept");
			// –î–æ–±–∞–≤–ª—è–µ–º –≤ —á—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Accept-Language
			this->addBlack("Accept-Language");
			// –î–æ–±–∞–≤–ª—è–µ–º –≤ —á—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Accept-Encoding
			this->addBlack("Accept-Encoding");
			// –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
			this->addHeader("Connection", "keep-alive");
			// –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞
			this->addHeader("Proxy-Connection", "keep-alive");
			// –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
			const string & auth = this->authCli.getHeader(true);
			// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω—ã
			if(!auth.empty()) this->addHeader("Proxy-Authorization", auth);
			// –§–æ—Ä–º–∏—Ä—É–µ–º URI –∑–∞–ø—Ä–æ—Å–∞
			this->query.uri = this->fmk->format("%s:%u", host.c_str(), url.port);
			// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
			return this->request(url, method_t::CONNECT);
		}
	}
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	return result;
}
/**
 * reject –ú–µ—Ç–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
 * @param code –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞
 * @param mess —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
 * @return     –±—É—Ñ–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ –≤ –±–∏–Ω–∞—Ä–Ω–æ–º –≤–∏–¥–µ
 */
vector <char> awh::Http::reject(const u_short code, const string & mess) const noexcept {
	// –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
	this->query.message = (!mess.empty() ? mess : this->getMessage(code));
	// –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ
	if(!this->query.message.empty()){
		// –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–≤–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
		if((code == 401) || (code == 407))
			// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
			this->headers.emplace("Connection", "keep-alive");
		// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
		else this->headers.emplace("Connection", "close");
		// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞
		this->headers.emplace("Content-type", "text/html; charset=utf-8");
		// –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è
		if((code >= 200) && (code != 204) && (code != 304) && (code != 308)){
			// –ï—Å–ª–∏ —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–≤–æ—ë
			if(this->body.empty()){
				// –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞
				const string & body = this->fmk->format(
					"<html><head><title>%u %s</title></head>\n<body><h2>%u %s</h2></body></html>",
					code, this->query.message.c_str(), code, this->query.message.c_str()
				);
				// –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è
				this->body.assign(body.begin(), body.end());
			}
			// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
			this->headers.emplace("Content-Length", to_string(this->body.size()));
		}
		// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
		return this->response(code, mess);
	}
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	return vector <char> ();
}
/**
 * response –ú–µ—Ç–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
 * @param code –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞
 * @param mess —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
 * @return     –±—É—Ñ–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ –≤ –±–∏–Ω–∞—Ä–Ω–æ–º –≤–∏–¥–µ
 */
vector <char> awh::Http::response(const u_short code, const string & mess) const noexcept {
	// –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
	vector <char> result;
	// –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
	this->query.message = (!mess.empty() ? mess : this->getMessage(code));
	// –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ
	if(!this->query.message.empty()){
		/**
		 * –¢–∏–ø—ã –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
		 */
		bool available[7] = {
			false, // Connection
			false, // Content-Type
			false, // Content-Length
			false, // Content-Encoding
			false, // Transfer-Encoding
			false, // X-AWH-Encryption
			false  // WWW-Authenticate
		};
		// –†–∞–∑–º–µ—Ä —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
		size_t length = 0;
		// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞
		this->query.code = code;
		// –î–∞–Ω–Ω—ã–µ REST –æ—Ç–≤–µ—Ç–∞
		string response = this->fmk->format("HTTP/%.1f %u %s\r\n", this->query.ver, code, this->query.message.c_str());
		// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –∑–∞–ø—Ä–µ—â—ë–Ω
		if(!this->isBlack("Date"))
			// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–∞—Ç—ã –≤ –æ—Ç–≤–µ—Ç
			response.append(this->fmk->format("Date: %s\r\n", this->date().c_str()));
		// –ü–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º—É —Å–ø–∏—Å–∫—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
		for(auto & header : this->headers){
			// –ü–æ–ª—É—á–∞–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
			const string & head = this->fmk->toLower(header.first);
			// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–µ–±–æ—Ä –≤—Å–µ—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
			for(u_short i = 0; i < 7; i++){
				// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —É–∂–µ –Ω–∞–π–¥–µ–Ω –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –µ–≥–æ
				if(available[i]) continue;
				// –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–≤–æ–µ—Ä–∫—É –∑–∞–≥–æ–ª–æ–≤–∫–∞
				switch(i){
					case 0: available[i] = (head.compare("connection") == 0);        break;
					case 1: available[i] = (head.compare("content-type") == 0);      break;
					case 3: available[i] = (head.compare("content-encoding") == 0);  break;
					case 4: available[i] = (head.compare("transfer-encoding") == 0); break;
					case 5: available[i] = (head.compare("x-awh-encryption") == 0);  break;
					case 6: available[i] = (head.compare("www-authenticate") == 0);  break;
					case 2: {
						// –ó–∞–ø–æ–º–∏–Ω–∞–µ–º, —á—Ç–æ –º—ã –Ω–∞—à–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–ª–∞
						available[i] = (head.compare("content-length") == 0);
						// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
						if(available[i]) length = stoull(header.second);
					} break;
				}
			}
			// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–º
			if(!available[2] && !available[4] && !available[5] && !this->isBlack(head))
				// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –æ—Ç–≤–µ—Ç
				response.append(this->fmk->format("%s: %s\r\n", header.first.c_str(), header.second.c_str()));
		}
		// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Connection –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
		if(!available[0] && !this->isBlack("Connection"))
			// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –æ—Ç–≤–µ—Ç
			response.append(this->fmk->format("Connection: %s\r\n", HTTP_HEADER_CONNECTION));
		// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Content-Type –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
		if(!available[1] && !this->isBlack("Content-Type"))
			// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –æ—Ç–≤–µ—Ç
			response.append(this->fmk->format("Content-Type: %s\r\n", HTTP_HEADER_CONTENTTYPE));
		// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –∑–∞–ø—Ä–µ—â—ë–Ω
		if(!this->isBlack("Server"))
			// –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –æ—Ç–≤–µ—Ç
			response.append(this->fmk->format("Server: %s\r\n", this->servName.c_str()));
		// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –∑–∞–ø—Ä–µ—â—ë–Ω
		if(!this->isBlack("X-Powered-By"))
			// –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–±–æ—á–µ–π —Å–∏—Å—Ç–µ–º—ã –≤ –æ—Ç–≤–µ—Ç
			response.append(this->fmk->format("X-Powered-By: %s/%s\r\n", this->servId.c_str(), this->servVer.c_str()));
		// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
		if(!available[6] && !this->isBlack("WWW-Authenticate")){
			// –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
			const string & auth = this->authSrv.getHeader();
			// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω—ã
			if(!auth.empty()) response.append(auth);
		}
		// –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–µ–ª–æ –∏ —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
		if((code >= 200) && (code != 204) && (code != 304) && (code != 308) && !this->body.empty()){
			// –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω—É–∂–Ω–æ –ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å —Ç–µ–ª–æ —Ä–∞–∑–±–∏–≤ –Ω–∞ —á–∞–Ω–∫–∏
			this->chunking = (!available[2] || ((length > 0) && (length != this->body.size())));
			// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
			if(this->crypt && !this->isBlack("X-AWH-Encryption")){
				// –í—ã–ø–æ–ª–Ω—è–µ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
				const auto & res = this->hash.encrypt(this->body.data(), this->body.size());
				// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã, –∑–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
				if(!res.empty()){
					// –ó–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
					this->body.assign(res.begin(), res.end());
					// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º X-AWH-Encryption
					response.append(this->fmk->format("X-AWH-Encryption: %u\r\n", (u_short) this->hash.getAES()));
				}
			}
			// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –∑–∞–ø—Ä–µ—â—ë–Ω
			if(!this->isBlack("Content-Encoding")){
				// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥ —Å–∂–∞—Ç–∏—è —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
				switch((uint8_t) this->compress){
					// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–∂–∞—Ç—å —Ç–µ–ª–æ –º–µ—Ç–æ–¥–æ–º BROTLI
					case (uint8_t) compress_t::BROTLI: {
						// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–∂–∞—Ç–∏–µ —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
						const auto & brotli = this->hash.compressBrotli(this->body.data(), this->body.size());
						// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å–∂–∞—Ç—ã, –∑–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
						if(!brotli.empty()){
							// –ó–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
							this->body.assign(brotli.begin(), brotli.end());
							// –ó–∞–º–µ–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ –¥–∞–Ω–Ω—ã—Ö
							if(!this->chunking) length = this->body.size();
							// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Content-Encoding –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
							if(!available[3]) response.append(this->fmk->format("Content-Encoding: %s\r\n", "br"));
						}
					} break;
					// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–∂–∞—Ç—å —Ç–µ–ª–æ –º–µ—Ç–æ–¥–æ–º GZIP
					case (uint8_t) compress_t::GZIP: {
						// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–∂–∞—Ç–∏–µ —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
						const auto & gzip = this->hash.compressGzip(this->body.data(), this->body.size());
						// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å–∂–∞—Ç—ã, –∑–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
						if(!gzip.empty()){
							// –ó–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
							this->body.assign(gzip.begin(), gzip.end());
							// –ó–∞–º–µ–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ –¥–∞–Ω–Ω—ã—Ö
							if(!this->chunking) length = this->body.size();
							// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Content-Encoding –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
							if(!available[3]) response.append(this->fmk->format("Content-Encoding: %s\r\n", "gzip"));
						}
					} break;
					// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–∂–∞—Ç—å —Ç–µ–ª–æ –º–µ—Ç–æ–¥–æ–º DEFLATE
					case (uint8_t) compress_t::DEFLATE: {
						// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–∂–∞—Ç–∏–µ —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
						auto deflate = this->hash.compress(this->body.data(), this->body.size());
						// –£–¥–∞–ª—è–µ–º —Ö–≤–æ—Å—Ç –≤ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
						this->hash.rmTail(deflate);
						// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å–∂–∞—Ç—ã, –∑–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
						if(!deflate.empty()){
							// –ó–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
							this->body.assign(deflate.begin(), deflate.end());
							// –ó–∞–º–µ–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ –¥–∞–Ω–Ω—ã—Ö
							if(!this->chunking) length = this->body.size();
							// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Content-Encoding –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
							if(!available[3]) response.append(this->fmk->format("Content-Encoding: %s\r\n", "deflate"));
						}
					} break;
				}
			}
			// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑–±–∏–≤–∞—Ç—å –Ω–∞ —á–∞–Ω–∫–∏
			if(this->chunking && !this->isBlack("Transfer-Encoding"))
				// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ Transfer-Encoding
				response.append(this->fmk->format("Transfer-Encoding: %s\r\n", "chunked"));
			// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞–∑–º–µ—Ä–∞ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ç–µ–ª–∞, –Ω–µ –∑–∞–ø—Ä–µ—â—ë–Ω
			else if(!this->isBlack("Content-Length"))
				// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ç–µ–ª–∞ Content-Length
				response.append(this->fmk->format("Content-Length: %zu\r\n", length));
		// –û—á–∏—â–∞–µ–º —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
		} else this->body.clear();
		// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–µ—Ä—à–∞—é—â–∏–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
		response.append("\r\n");
		// –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–≤–µ—Ç–∞
		result.assign(response.begin(), response.end());
	}
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	return result;
}
/**
 * request –ú–µ—Ç–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞
 * @param url    –æ–±—ä–µ–∫—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ REST –∑–∞–ø—Ä–æ—Å–∞
 * @param method –º–µ—Ç–æ–¥ REST –∑–∞–ø—Ä–æ—Å–∞
 * @return       –±—É—Ñ–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ –≤ –±–∏–Ω–∞—Ä–Ω–æ–º –≤–∏–¥–µ
 */
vector <char> awh::Http::request(const uri_t::url_t & url, const method_t method) const noexcept {
	// –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
	vector <char> result;
	// –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã REST –∑–∞–ø—Ä–æ—Å–∞ –ø–µ—Ä–µ–¥–∞–Ω—ã
	if(!url.empty()){
		// –ü–æ–ª—É—á–∞–µ–º —Ö–æ—Å—Ç –∑–∞–ø—Ä–æ—Å–∞
		const string & host = (!url.domain.empty() ? url.domain : url.ip);
		// –ï—Å–ª–∏ —Ö–æ—Å—Ç –ø–æ–ª—É—á–µ–Ω
		if(!host.empty()){
			/**
			 * –¢–∏–ø—ã –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
			 */
			bool available[11] = {
				false, // Host
				false, // Accept
				false, // Origin
				false, // User-Agent
				false, // Connection
				false, // Content-Length
				false, // Accept-Language
				false, // Content-Encoding
				false, // Transfer-Encoding
				false, // X-AWH-Encryption
				false  // Proxy-Authorization
			};
			// –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
			this->url = url;
			// –†–∞–∑–º–µ—Ä —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
			size_t length = 0;
			// –î–∞–Ω–Ω—ã–µ REST –∑–∞–ø—Ä–æ—Å–∞
			string request = "";
			// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã REST –∑–∞–ø—Ä–æ—Å–∞
			this->authCli.setUri(this->uri->createUrl(url));
			// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –Ω–µ CONNECT –∏–ª–∏ URI –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
			if((method != method_t::CONNECT) || this->query.uri.empty())
				// –§–æ—Ä–º–∏—Ä—É–µ–º HTTP –∑–∞–ø—Ä–æ—Å
				this->query.uri = this->uri->createQuery(url);
			// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞
			switch((uint8_t) method){
				// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞ —É–∫–∞–∑–∞–Ω –∫–∞–∫ GET
				case (uint8_t) method_t::GET:
					// –§–æ—Ä–º–∏—Ä—É–µ–º GET –∑–∞–ø—Ä–æ—Å
					request = this->fmk->format("GET %s HTTP/%.1f\r\n", this->query.uri.c_str(), this->query.ver);
				break;
				// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞ —É–∫–∞–∑–∞–Ω –∫–∞–∫ PUT
				case (uint8_t) method_t::PUT:
					// –§–æ—Ä–º–∏—Ä—É–µ–º PUT –∑–∞–ø—Ä–æ—Å
					request = this->fmk->format("PUT %s HTTP/%.1f\r\n", this->query.uri.c_str(), this->query.ver);
				break;
				// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞ —É–∫–∞–∑–∞–Ω –∫–∞–∫ POST
				case (uint8_t) method_t::POST:
					// –§–æ—Ä–º–∏—Ä—É–µ–º POST –∑–∞–ø—Ä–æ—Å
					request = this->fmk->format("POST %s HTTP/%.1f\r\n", this->query.uri.c_str(), this->query.ver);
				break;
				// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞ —É–∫–∞–∑–∞–Ω –∫–∞–∫ HEAD
				case (uint8_t) method_t::HEAD:
					// –§–æ—Ä–º–∏—Ä—É–µ–º HEAD –∑–∞–ø—Ä–æ—Å
					request = this->fmk->format("HEAD %s HTTP/%.1f\r\n", this->query.uri.c_str(), this->query.ver);
				break;
				// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞ —É–∫–∞–∑–∞–Ω –∫–∞–∫ PATCH
				case (uint8_t) method_t::PATCH:
					// –§–æ—Ä–º–∏—Ä—É–µ–º PATCH –∑–∞–ø—Ä–æ—Å
					request = this->fmk->format("PATCH %s HTTP/%.1f\r\n", this->query.uri.c_str(), this->query.ver);
				break;
				// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞ —É–∫–∞–∑–∞–Ω –∫–∞–∫ TRACE
				case (uint8_t) method_t::TRACE:
					// –§–æ—Ä–º–∏—Ä—É–µ–º TRACE –∑–∞–ø—Ä–æ—Å
					request = this->fmk->format("TRACE %s HTTP/%.1f\r\n", this->query.uri.c_str(), this->query.ver);
				break;
				// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞ —É–∫–∞–∑–∞–Ω –∫–∞–∫ DELETE
				case (uint8_t) method_t::DEL:
					// –§–æ—Ä–º–∏—Ä—É–µ–º DELETE –∑–∞–ø—Ä–æ—Å
					request = this->fmk->format("DELETE %s HTTP/%.1f\r\n", this->query.uri.c_str(), this->query.ver);
				break;
				// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞ —É–∫–∞–∑–∞–Ω –∫–∞–∫ OPTIONS
				case (uint8_t) method_t::OPTIONS:
					// –§–æ—Ä–º–∏—Ä—É–µ–º OPTIONS –∑–∞–ø—Ä–æ—Å
					request = this->fmk->format("OPTIONS %s HTTP/%.1f\r\n", this->query.uri.c_str(), this->query.ver);
				break;
				// –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞ —É–∫–∞–∑–∞–Ω –∫–∞–∫ CONNECT
				case (uint8_t) method_t::CONNECT:
					// –§–æ—Ä–º–∏—Ä—É–µ–º CONNECT –∑–∞–ø—Ä–æ—Å
					request = this->fmk->format("CONNECT %s HTTP/%.1f\r\n", this->query.uri.c_str(), this->query.ver);
				break;
			}
			// –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞
			this->query.method = method;
			// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –∑–∞–ø—Ä–µ—â—ë–Ω
			if(!this->isBlack("Date"))
				// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–∞—Ç—ã –≤ –∑–∞–ø—Ä–æ—Å
				request.append(this->fmk->format("Date: %s\r\n", this->date().c_str()));
			// –ü–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º—É —Å–ø–∏—Å–∫—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
			for(auto & header : this->headers){
				// –ü–æ–ª—É—á–∞–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
				const string & head = this->fmk->toLower(header.first);
				// –í—ã–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–µ–±–æ—Ä –≤—Å–µ—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
				for(u_short i = 0; i < 11; i++){
					// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —É–∂–µ –Ω–∞–π–¥–µ–Ω –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –µ–≥–æ
					if(available[i]) continue;
					// –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–≤–æ–µ—Ä–∫—É –∑–∞–≥–æ–ª–æ–≤–∫–∞
					switch(i){
						case 0:  available[i] = (head.compare("host") == 0);                  break;
						case 1:  available[i] = (head.compare("accept") == 0);                break;
						case 2:  available[i] = (head.compare("origin") == 0);                break;
						case 3:  available[i] = (head.compare("user-agent") == 0);            break;
						case 4:  available[i] = (head.compare("connection") == 0);            break;
						case 6:  available[i] = (head.compare("accept-language") == 0);       break;
						case 7:  available[i] = (head.compare("content-encoding") == 0);      break;
						case 8:  available[i] = (head.compare("transfer-encoding") == 0);     break;
						case 9:  available[i] = (head.compare("x-awh-encryption") == 0);      break;
						case 10: available[i] = ((head.compare("authorization") == 0) ||
							                     (head.compare("proxy-authorization") == 0)); break;
						case 5: {
							// –ó–∞–ø–æ–º–∏–Ω–∞–µ–º, —á—Ç–æ –º—ã –Ω–∞—à–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–ª–∞
							available[i] = (head.compare("content-length") == 0);
							// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
							if(available[i]) length = stoull(header.second);
						} break;
					}
				}
				// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–º
				if(!available[5] && !available[8] && !available[9] && !this->isBlack(head))
					// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –∑–∞–ø—Ä–æ—Å
					request.append(this->fmk->format("%s: %s\r\n", header.first.c_str(), header.second.c_str()));
			}
			// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Host –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
			if(!available[0] && !this->isBlack("Host"))
				// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –∑–∞–ø—Ä–æ—Å
				request.append(this->fmk->format("Host: %s\r\n", host.c_str()));
			// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Accept –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
			if(!available[1] && (method != method_t::CONNECT) && !this->isBlack("Accept"))
				// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –∑–∞–ø—Ä–æ—Å
				request.append(this->fmk->format("Accept: %s\r\n", HTTP_HEADER_ACCEPT));
			// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Origin –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
			if(!available[2] && !this->isBlack("Origin"))
				// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –∑–∞–ø—Ä–æ—Å
				request.append(this->fmk->format("Origin: %s\r\n", this->uri->createOrigin(url).c_str()));
			// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Connection –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
			if(!available[4] && !this->isBlack("Connection"))
				// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –∑–∞–ø—Ä–æ—Å
				request.append(this->fmk->format("Connection: %s\r\n", HTTP_HEADER_CONNECTION));
			// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Accept-Language –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
			if(!available[6] && (method != method_t::CONNECT) && !this->isBlack("Accept-Language"))
				// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –∑–∞–ø—Ä–æ—Å
				request.append(this->fmk->format("Accept-Language: %s\r\n", HTTP_HEADER_ACCEPTLANGUAGE));
			// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Å–∂–∞—Ç–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
			if((this->compress != compress_t::NONE) && (method != method_t::CONNECT) && !this->isBlack("Accept-Encoding"))
				// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –∑–∞–ø—Ä–æ—Å
				request.append(this->fmk->format("Accept-Encoding: %s\r\n", HTTP_HEADER_ACCEPTENCODING));
			// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º User-Agent –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
			if(!available[3] && !this->isBlack("User-Agent")){
				// –ï—Å–ª–∏ User-Agent —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π
				if(this->userAgent.compare(HTTP_HEADER_AGENT) == 0){
					// –ù–∞–∑–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
					const char * nameOs = nullptr;
					// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
					switch((uint8_t) this->fmk->os()){
						// –ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π —è–≤–ª—è–µ—Ç—Å—è Unix
						case (uint8_t) fmk_t::os_t::UNIX: nameOs = "Unix"; break;
						// –ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π —è–≤–ª—è–µ—Ç—Å—è Linux
						case (uint8_t) fmk_t::os_t::LINUX: nameOs = "Linux"; break;
						// –ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–π
						case (uint8_t) fmk_t::os_t::NONE: nameOs = "Unknown"; break;
						// –ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π —è–≤–ª—è–µ—Ç—Å—è Windows
						case (uint8_t) fmk_t::os_t::WIND32:
						case (uint8_t) fmk_t::os_t::WIND64: nameOs = "Windows"; break;
						// –ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π —è–≤–ª—è–µ—Ç—Å—è MacOS X
						case (uint8_t) fmk_t::os_t::MACOSX: nameOs = "MacOS X"; break;
						// –ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π —è–≤–ª—è–µ—Ç—Å—è FreeBSD
						case (uint8_t) fmk_t::os_t::FREEBSD: nameOs = "FreeBSD"; break;
					}
					// –í—ã–ø–æ–ª–Ω—è–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –Æ–∑–µ—Ä-–∞–≥–µ–Ω—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω—è—é—â–µ–≥–æ HTTP –∑–∞–ø—Ä–æ—Å
					this->userAgent = this->fmk->format("Mozilla/5.0 (%s; %s) %s/%s", nameOs, this->servName.c_str(), this->servId.c_str(), this->servVer.c_str());
				}
				// –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –∑–∞–ø—Ä–æ—Å
				request.append(this->fmk->format("User-Agent: %s\r\n", this->userAgent.c_str()));
			}
			// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
			if(!available[10] && !this->isBlack("Authorization")){
				// –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
				const string & auth = this->authCli.getHeader();
				// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω—ã
				if(!auth.empty()) request.append(auth);
			}
			// –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–µ —è–≤–ª—è–µ—Ç—Å—è GET, HEAD –∏–ª–∏ TRACE, –∞ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
			if((method != method_t::GET) && (method != method_t::HEAD) && (method != method_t::TRACE) && !this->body.empty()){
				// –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω—É–∂–Ω–æ –ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å —Ç–µ–ª–æ —Ä–∞–∑–±–∏–≤ –Ω–∞ —á–∞–Ω–∫–∏
				this->chunking = (!available[5] || ((length > 0) && (length != this->body.size())));
				// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
				if(this->crypt && !this->isBlack("X-AWH-Encryption")){
					// –í—ã–ø–æ–ª–Ω—è–µ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
					const auto & res = this->hash.encrypt(this->body.data(), this->body.size());
					// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã, –∑–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
					if(!res.empty()){
						// –ó–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
						this->body.assign(res.begin(), res.end());
						// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º X-AWH-Encryption
						request.append(this->fmk->format("X-AWH-Encryption: %u\r\n", (u_short) this->hash.getAES()));
					}
				}
				// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –∑–∞–ø—Ä–µ—â—ë–Ω
				if(!this->isBlack("Content-Encoding")){
					// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥ —Å–∂–∞—Ç–∏—è —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
					switch((uint8_t) this->compress){
						// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–∂–∞—Ç—å —Ç–µ–ª–æ –º–µ—Ç–æ–¥–æ–º BROTLI
						case (uint8_t) compress_t::BROTLI: {
							// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–∂–∞—Ç–∏–µ —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
							const auto & brotli = this->hash.compressBrotli(this->body.data(), this->body.size());
							// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å–∂–∞—Ç—ã, –∑–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
							if(!brotli.empty()){
								// –ó–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
								this->body.assign(brotli.begin(), brotli.end());
								// –ó–∞–º–µ–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ –¥–∞–Ω–Ω—ã—Ö
								if(!this->chunking) length = this->body.size();
								// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Content-Encoding –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
								if(!available[7]) request.append(this->fmk->format("Content-Encoding: %s\r\n", "br"));
							}
						} break;
						// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–∂–∞—Ç—å —Ç–µ–ª–æ –º–µ—Ç–æ–¥–æ–º GZIP
						case (uint8_t) compress_t::GZIP: {
							// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–∂–∞—Ç–∏–µ —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
							const auto & gzip = this->hash.compressGzip(this->body.data(), this->body.size());
							// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å–∂–∞—Ç—ã, –∑–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
							if(!gzip.empty()){
								// –ó–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
								this->body.assign(gzip.begin(), gzip.end());
								// –ó–∞–º–µ–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ –¥–∞–Ω–Ω—ã—Ö
								if(!this->chunking) length = this->body.size();
								// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Content-Encoding –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
								if(!available[7]) request.append(this->fmk->format("Content-Encoding: %s\r\n", "gzip"));
							}
						} break;
						// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–∂–∞—Ç—å —Ç–µ–ª–æ –º–µ—Ç–æ–¥–æ–º DEFLATE
						case (uint8_t) compress_t::DEFLATE: {
							// –í—ã–ø–æ–ª–Ω—è–µ–º —Å–∂–∞—Ç–∏–µ —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
							auto deflate = this->hash.compress(this->body.data(), this->body.size());
							// –£–¥–∞–ª—è–µ–º —Ö–≤–æ—Å—Ç –≤ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
							this->hash.rmTail(deflate);
							// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å–∂–∞—Ç—ã, –∑–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
							if(!deflate.empty()){
								// –ó–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–æ –¥–∞–Ω–Ω—ã—Ö
								this->body.assign(deflate.begin(), deflate.end());
								// –ó–∞–º–µ–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ –¥–∞–Ω–Ω—ã—Ö
								if(!this->chunking) length = this->body.size();
								// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Content-Encoding –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
								if(!available[7]) request.append(this->fmk->format("Content-Encoding: %s\r\n", "deflate"));
							}
						} break;
					}
				}
				// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑–±–∏–≤–∞—Ç—å –Ω–∞ —á–∞–Ω–∫–∏
				if(this->chunking && !this->isBlack("Transfer-Encoding"))
					// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ Transfer-Encoding
					request.append(this->fmk->format("Transfer-Encoding: %s\r\n", "chunked"));
				// –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞–∑–º–µ—Ä–∞ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ç–µ–ª–∞, –Ω–µ –∑–∞–ø—Ä–µ—â—ë–Ω
				else if(!this->isBlack("Content-Length"))
					// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ç–µ–ª–∞ Content-Length
					request.append(this->fmk->format("Content-Length: %zu\r\n", length));
			// –û—á–∏—â–∞–µ–º —Ç–µ–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
			} else this->body.clear();
			// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–µ—Ä—à–∞—é—â–∏–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
			request.append("\r\n");
			// –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞
			result.assign(request.begin(), request.end());
		}
	}
	// –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	return result;
}
/**
 * setChunkingFn –ú–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —á–∞–Ω–∫–æ–≤
 * @param callback —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
 */
void awh::Http::setChunkingFn(function <void (const vector <char> &, const Http *)> callback) noexcept {
	// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
	this->chunkingFn = callback;
}
/**
 * setChunkSize –ú–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ —á–∞–Ω–∫–∞
 * @param size —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
 */
void awh::Http::setChunkSize(const size_t size) noexcept {
	// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞
	if(size >= 100) this->chunkSize = size;
}
/**
 * setUserAgent –ú–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ User-Agent –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–∞
 * @param userAgent –∞–≥–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–∞
 */
void awh::Http::setUserAgent(const string & userAgent) noexcept {
	// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º UserAgent
	if(!userAgent.empty()) this->userAgent = userAgent;
}
/**
 * setServ –ú–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞
 * @param id   –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Ä–≤–∏—Å–∞
 * @param name –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
 * @param ver  –≤–µ—Ä—Å–∏—è —Å–µ—Ä–≤–∏—Å–∞
 */
void awh::Http::setServ(const string & id, const string & name, const string & ver) noexcept {
	// –ï—Å–ª–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Ä–≤–∏—Å–∞ –ø–µ—Ä–µ–¥–∞–Ω, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
	if(!id.empty()) this->servId = id;
	// –ï—Å–ª–∏ –≤–µ—Ä—Å–∏—è —Å–µ—Ä–≤–∏—Å–∞ –ø–µ—Ä–µ–¥–∞–Ω–∞
	if(!ver.empty()) this->servVer = ver;
	// –ï—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –ø–µ—Ä–µ–¥–∞–Ω–æ, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
	if(!name.empty()) this->servName = name;
}
/**
 * setCrypt –ú–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
 * @param pass –ø–∞—Ä–æ–ª—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
 * @param salt —Å–æ–ª—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
 * @param aes  —Ä–∞–∑–º–µ—Ä —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
 */
void awh::Http::setCrypt(const string & pass, const string & salt, const hash_t::aes_t aes) noexcept {
	// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
	this->crypt = !pass.empty();
	// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
	this->hash.setAES(aes);
	// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ–ª—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
	this->hash.setSalt(salt);
	// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–∞—Ä–æ–ª—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
	this->hash.setPassword(pass);
}
